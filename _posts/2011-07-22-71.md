---
ID: 71
post_title: Internet od Netii i parametr MTU
author: Piotr Ciruk
post_excerpt: ""
layout: post
permalink: http://ciruk.pl/2011/07/71/
published: true
post_date: 2011-07-22 12:52:31
---
Jednym z problemów występujących w usłudze Netii zapewniającej dostęp do Internetu oparty na technologii ADSL/ADSL2 jest brak możliwości wyświetlenia co poniektórych witryn internetowych przy domyślnych ustawieniach systemowych (dotyczy systemów z rodziny Microsoft Windows).
Najlepszym rozwiązaniem jest modyfikacja paramteru definiującego rozmiar największego datagramu (<a href="http://pl.wikipedia.org/wiki/Maximum_Transmission_Unit" title="MTU" target="_blank">MTU</a>). Dla usługi Netii optymalna wartość parametru znajduje się w przedziale <1432, 1492>. Aby wyznaczyć wartość odpowiednią dla danego węzła sieci, należy z linii poleceń uruchomić następujący program:
[sourcecode language="bash"]
ping -f -l 1464 eti.pg.gda.pl -t
[/sourcecode]
W wypadku otrzymania odpowiedzi:
[sourcecode language="bash"]
Pakiet musi być podzielony na fragmenty, ale ustawiono opcję DF.
[/sourcecode]
należy zmodyfikować liczbową wartość 1464 na niższą (np. o 10: 1454, a dalej stopniowo do 1404 włącznie).
W momencie uzyskania odpowiedzi, np.:
[sourcecode language="bash"]
Odpowiedź z 67.215.77.132: bajtów=1464 czas=63ms TTL=57
[/sourcecode]
do liczbowej wartość dodajemy rozmiar nagłówka pakietu (28), co w rezultacie daje wartości z przediału MTU Netii <1432, 1492>.
W systemach Windows Vista oraz Windows 7 do ustawienia parametru MTU służy program netsh. Aby wyświetlić dostępne połączenia wykonujemy polecenie:
[sourcecode language="bash"]
netsh interface ipv4 show subinterfaces
[/sourcecode]
Z kolumny 'Interfejsy' odczytujemy nazwę połączenia, dla którego chcemy zmodyfikować parametr MTU, po czym wykoujemy polecenie:
[sourcecode language="bash"]
netsh interface ipv4 set subinterface &quot;{NAZWA_POŁĄCZENIA}&quot; mtu={WARTOŚĆ_MTU} store=persistent
[/sourcecode]
np:
[sourcecode language="bash"]
netsh interface ipv4 set subinterface &quot;Połączenie lokalne&quot; mtu=1492 store=persistent
[/sourcecode]

W starszych systemach konieczne jest utworzenie wpisów w rejestrze (<a href="http://www.windowsreference.com/windows-2000/how-to-manually-set-the-mtu-size-in-windows-xp-2003-2000-vista/" title="link" target="_blank">link</a>). Można te operacje przeprowadzić automatycznie, np. za pomocą programu TCP Optimizer.